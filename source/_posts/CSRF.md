---
title: CSRF
date: 2018-07-23 18:15:30
tags:
  - CSRF
categories:
  - 安全
---


# 什么是CSRF攻击

CSRF，即跨站请求伪造（Cross-Site Request Forgery），是一种网络安全漏洞，攻击者利用这个漏洞可以迫使用户在不知情的情况下执行他们没有授权的操作。这种攻击通常发生在用户已经登录了一个信任的网站，并且他们的登录会话（如cookie）仍然有效的情况下。

# CSRF攻击的工作原理

1. 用户登录受信任的网站：用户访问并登录了一个网站，比如他们的银行账户。
2. 攻击者创建恶意网站或链接：攻击者创建一个包含恶意请求的网页或链接，这些请求可能看起来无害，但实际上是向用户已登录的网站发送的。
3. 用户访问恶意网站或点击链接：用户可能无意中访问了这个恶意网站，或者点击了包含恶意请求的链接。
4. 浏览器发送请求：由于用户的浏览器已经包含了对受信任网站的登录凭证（如cookie），浏览器会自动将这些凭证发送到恶意请求的目标网站。
5. 目标网站执行操作：如果目标网站没有适当的CSRF防护措施，它可能会错误地认为请求来自用户本人，并执行请求的操作，比如转账或更改密码。

# 如何防范CSRF攻击
1. 使用CSRF令牌：在表单中添加一个随机生成的令牌，服务器在处理请求时验证这个令牌。
2. 验证Referer头部：检查HTTP请求的Referer头部，确保请求是从合法的来源发起的。
3. 设置SameSite Cookie属性：使用SameSite属性来限制Cookie在跨站请求中的使用。
4. 双重Cookie验证：在客户端和服务器端都存储一个值，提交表单时进行验证。
5. 使用POST方法：避免使用GET方法执行敏感操作，因为GET请求可以通过URL传递数据。
6. 内容安全策略（CSP）：使用CSP来限制网页可以加载哪些资源。